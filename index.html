<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accès formation</title>
  <style>
    :root {
      --bg: #f6f0e7;
      --ink: #2c2e39;
      --muted: #67606a;
      --line: #ebdccb;
      --card: #fffdfa;
      --logo-orange: #c96e20;
      --logo-orange-strong: #ae5c18;
      --logo-amber: #e6bf51;
      --logo-amber-strong: #d6ab3e;
      --logo-brown: #7f4b22;
      --logo-ink: #343748;
      --danger: #9a3030;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      font-family: "Segoe UI", Arial, sans-serif;
      color: var(--ink);
      background:
        radial-gradient(1120px 520px at -10% -15%, #f2e2cf 0%, transparent 58%),
        radial-gradient(880px 420px at 108% 110%, #f3e6be 0%, transparent 52%),
        radial-gradient(620px 320px at 50% 112%, #efe4d7 0%, transparent 60%),
        var(--bg);
      padding: 24px;
    }

    .card {
      width: min(94vw, 560px);
      position: relative;
      background: linear-gradient(180deg, #fffefc 0%, var(--card) 100%);
      border: 1px solid var(--line);
      border-radius: 24px;
      padding: 28px;
      box-shadow: 0 24px 56px rgba(66, 45, 25, .14);
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0 0 auto 0;
      height: 5px;
      background: linear-gradient(90deg, var(--logo-orange) 0%, var(--logo-amber) 58%, #f0d68a 100%);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 12px;
    }

    .brand img {
      width: 68px;
      height: 68px;
      object-fit: contain;
      border-radius: 14px;
      background: #fff;
      border: 1px solid #eee0d3;
      padding: 6px;
      box-shadow: 0 8px 24px rgba(35, 26, 20, .12);
    }

    .brand-meta {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-kicker {
      margin: 0;
      font-size: 12px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: #8e6134;
      font-weight: 700;
    }

    h1 {
      margin: 0;
      font-size: clamp(30px, 4.6vw, 42px);
      letter-spacing: -.02em;
      line-height: 1.03;
      color: #2f3140;
    }

    .subtitle {
      margin: 10px 0 18px;
      color: var(--muted);
      font-size: 1.06rem;
    }

    label {
      display: block;
      font-size: 13px;
      color: #695b53;
      margin: 0 0 6px;
      font-weight: 600;
    }

    input,
    button {
      width: 100%;
      border-radius: 12px;
      font-size: 17px;
    }

    input {
      border: 1px solid #d8c7b8;
      padding: 13px 14px;
      background: #fff;
      outline: none;
      transition: border-color .15s ease, box-shadow .15s ease;
    }

    input:focus {
      border-color: #c37936;
      box-shadow: 0 0 0 4px rgba(201, 110, 32, .16);
    }

    button {
      border: 0;
      padding: 13px 14px;
      color: #fff;
      font-weight: 700;
      cursor: pointer;
      transition: transform .14s ease, box-shadow .14s ease, background-color .14s ease;
    }

    button:hover {
      transform: translateY(-1px);
    }

    button:active {
      transform: translateY(0);
    }

    .btn-primary {
      margin-top: 12px;
      background: linear-gradient(135deg, var(--logo-orange) 0%, var(--logo-amber) 100%);
      color: #2a1d10;
      box-shadow: 0 12px 24px rgba(174, 92, 24, .34);
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, var(--logo-orange-strong) 0%, var(--logo-amber-strong) 100%);
    }

    .hint {
      margin: 18px 0 10px;
      color: #64574f;
      font-size: 1.01rem;
    }

    .btn-secondary {
      background: linear-gradient(135deg, var(--logo-ink) 0%, #44495d 100%);
      border: 1px solid rgba(255, 255, 255, .09);
      box-shadow: 0 12px 24px rgba(52, 55, 72, .33);
    }

    .btn-secondary:hover {
      background: linear-gradient(135deg, #2d3040 0%, #3a3f54 100%);
    }

    #error,
    #checkoutMsg {
      margin-top: 10px;
      min-height: 22px;
      font-size: 14px;
    }

    #error { color: var(--danger); }
    #checkoutMsg { color: var(--muted); }

    @media (max-width: 600px) {
      .card { padding: 20px; border-radius: 16px; }
      .brand img { width: 58px; height: 58px; }
      .subtitle { margin-bottom: 14px; }
    }
  </style>
<style data-global-dotted-bg-v1="1">
body {
  background:
    radial-gradient(circle at 12% 8%, rgba(226, 186, 83, 0.18) 0, rgba(226, 186, 83, 0.18) 2px, transparent 3px) 0 0 / 22px 22px,
    #ffffff !important;
}
</style></head>
<body>
  <main class="card">
    <div class="brand">
      <img src="LAB_(17).png" alt="Logo Brand Studio" />
      <div class="brand-meta">
        <p class="brand-kicker">Espace client</p>
        <h1>Formation Brand Studio</h1>
      </div>
    </div>

    <p class="subtitle">Entre ton code d'accès pour démarrer ton parcours.</p>

    <form id="loginForm">
      <label for="accessCode">Code d'accès</label>
      <input id="accessCode" type="password" autocomplete="off" required />
      <button type="submit" class="btn-primary">Entrer</button>
      <div id="error" aria-live="polite"></div>
    </form>

    <p class="hint">Pas encore de code ?</p>
    <button id="buyBtn" type="button" class="btn-secondary">Souscrire à la formation</button>
    <div id="checkoutMsg" aria-live="polite"></div>
  </main>

  <script>
    const VALID_CODES_FALLBACK = ["MARINE2026", "BRANDVIP"];
    const AUTH_KEY = "brandstudio_access_granted";
    const USER_CODE_KEY = "brandstudio_user_code_v1";
    const TARGET_PAGE = "En route vers ta nouvelle stratégie de marque 295057792efe80aabdfeebdd4704fcac.html";

    if (localStorage.getItem(AUTH_KEY) === "1" && localStorage.getItem(USER_CODE_KEY)) {
      window.location.href = TARGET_PAGE;
    }

    async function validateCode(code) {
      if (VALID_CODES_FALLBACK.includes(code)) return true;
      try {
        const res = await fetch("/api/validate-code", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ code })
        });

        if (!res.ok) return VALID_CODES_FALLBACK.includes(code);
        const json = await res.json();
        return !!json.valid;
      } catch (e) {
        return VALID_CODES_FALLBACK.includes(code);
      }
    }

    document.getElementById("loginForm").addEventListener("submit", async function (event) {
      event.preventDefault();
      const input = document.getElementById("accessCode");
      const error = document.getElementById("error");
      const code = input.value.trim().toUpperCase();
      error.textContent = "";

      const ok = await validateCode(code);
      if (ok) {
        localStorage.setItem(AUTH_KEY, "1");
        localStorage.setItem(USER_CODE_KEY, code);
        window.location.href = TARGET_PAGE;
      } else {
        error.textContent = "Code invalide.";
        input.select();
      }
    });

    document.getElementById("buyBtn").addEventListener("click", async function () {
      const msg = document.getElementById("checkoutMsg");
      msg.textContent = "Redirection vers le paiement...";
      try {
        const res = await fetch("/api/create-checkout-session", { method: "POST" });
        const json = await res.json();
        if (!res.ok || !json.url) {
          const parts = [];
          if (json && json.error) parts.push(json.error);
          if (json && json.details) parts.push(json.details);
          const detail = parts.length ? ` (${parts.join(" - ")})` : "";
          msg.textContent = "Impossible de lancer le paiement pour l'instant." + detail;
          return;
        }
        window.location.href = json.url;
      } catch (e) {
        msg.textContent = "Erreur réseau pendant la création du paiement.";
      }
    });
  </script>
</body>
</html>



